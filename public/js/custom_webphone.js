!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=1)}({1:function(e,t,n){e.exports=n("DLio")},DLio:function(e,t){function n(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,l=!0,r=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return l=e.done,e},e:function(e){r=!0,d=e},f:function(){try{l||null==n.return||n.return()}finally{if(r)throw d}}}}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],o=!0,a=!1,i=void 0;try{for(var d,l=e[Symbol.iterator]();!(o=(d=l.next()).done)&&(n.push(d.value),!t||n.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var d,l,r=0,u="",s=new Date,c=!1,p=0,m=!1,g=!0,b="key",y="key",v=null,f=null,_=null;$.ajaxSetup({headers:{"X-CSRF-TOKEN":jQuery('meta[name="csrf-token"]').attr("content")}}),window.initCustomWebphone=function(){var e=document.getElementsByClassName("container-fluid"),t=document.createElement("div");t.setAttribute("id","divMizuvoipControl"),t.setAttribute("class","card card-purple"),t.setAttribute("style","position: absolute;top:80px;right:40px;width:245px;z-index:1032;display:none;background-color: rgba(0, 0, 0, 0.1);"),t.innerHTML='<div class="card-header" id="divMizuvoipControlHeader" style="cursor: move;opacity:0.9;"><div class="card-title">Mizuvoip</div><div class="card-tools"><button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i></button></div></div><div class="card-body py-0" id="divMizuvoipControlBody" style="background-color: rgba(0, 0, 0, 0);"><div class="row py-1"><div class="input-group w-100"><input type="text" class="form-control" placeholder="Destination number" id="destnumber" autocapitalize="off"><div class="input-group-append" id="dial_group"><button class="btn btn-success" type="button" id="btn_call" onclick="Call();"><i class="fas fa-phone"></i></button></div></div></div><div class="row py-1" id="pendingDateTimeRow"><div class="input-group date" id="pendingDateTime" data-target-input="nearest"><input type="text" class="form-control datetimepicker-input" data-target="#pendingDateTime" placeholder="Pending" readonly/><div class="input-group-append" data-target="#pendingDateTime" data-toggle="datetimepicker"><div class="input-group-text"><i class="fa fa-calendar"></i></div></div></div><div class="btn-group w-100 mt-1" role="group"><button type="button" class="btn btn-primary" id="btn_pending" onclick="Pending();" disabled>Pending</button><button type="button" class="btn btn-danger" id="btn_clear_pending" onclick="clearPending();">Clear</button></div></div><div class="row py-1" id="incoming_call_layout"><div class="btn-group w-100" role="group"><button type="button" class="btn btn-success" id="btn_accept" onclick="Accept();">Accept</button><button type="button" class="btn btn-danger" id="btn_reject" onclick="Reject();">Reject</button></div></div><iframe allow="microphone; camera" style="display:none" height="0" width="0" id="loader"></iframe><div id="video_container" style="display: none;"></div></div>',e[0].appendChild(t),dragElement(document.getElementById("divMizuvoipControl"));var n=document.createElement("div");n.setAttribute("id","divMizuvoipSideControl"),n.setAttribute("class","card card-purple"),n.innerHTML='<div class="card-header"><div class="card-title">Mizu VOIP</div><div class="card-tools"><button type="button" class="btn btn-tool btn-danger" id="btn_stop" onclick="Stop()" style="visibility:hidden;"><i class="fas fa-power-off"></i></button></div></div><div class="card-body"><div class="row py-1"><div class="btn-group w-100" role="group"><button type="button" class="btn btn-primary" id="btn_hold" onclick="Hold(true);">Hold</button></div></div><div class="row py-1"><div class="form-group row mb-0 ml-1"><label for="drp_aux" class="col-sm-3 col-form-label">AUX</label><div class="col-sm-9"><select class="form-control select2 w-100" id="drp_aux" onchange="Aux()"><option value="0" selected="">Ready</option><option value="1" id="drp_aux_1">Konsultasi</option><option value="2" id="drp_aux_2">Supporting</option><option value="3" id="drp_aux_3">CatHSTR</option><option value="4" id="drp_aux_4">Toilet</option><option value="5" id="drp_aux_5">Air Minum</option><option value="6" id="drp_aux_6">Sholat</option><option value="7" id="drp_aux_7">Lunch</option><option value="8" id="drp_aux_8">Briefing</option><option value="9" id="drp_aux_9">Update System</option></select></div></div></div></div>',document.getElementById("mizuSideControl").appendChild(n),$("#pendingDateTime").datetimepicker({icons:{time:"far fa-clock"},format:"YYYY-MM-DD HH:mm:ss",ignoreReadonly:!0}),$("#pendingDateTime").on("change.datetimepicker",(function(e){document.getElementById("btn_pending").disabled=!1})),$("#pendingDateTime").datetimepicker("readonly"),document.getElementById("incoming_call_layout").style.display="none"},window.Pending=function(){var e=$("#pendingDateTime").datetimepicker("viewDate");console.log(moment(e).format("YYYY-MM-DD HH:mm:ss"))},window.clearPending=function(){$("#pendingDateTime").datetimepicker("clear"),document.getElementById("btn_pending").disabled=!0},window.hideElement=function(){document.getElementById("divMizuvoipControl").style.display="none"},window.showElement=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=document.getElementById("divMizuvoipControl");t.style.display="block","inbound"==e?(document.getElementById("btn_call").style.display="none",document.getElementById("destnumber").disabled=!0):(document.getElementById("btn_call").style.display="block",document.getElementById("incoming_call_layout").style.display="none",document.getElementById("destnumber").disabled=!1)},window.canSwitchServer=function(){$.ajax({type:"POST",url:"/mizuvoip/getLoginDuration",success:function(e){return 1==e},error:function(e){console.log("ERR RelExt"),console.log(e)}})},window.setCampaignId=function(e){f=e},window.getCampaignId=function(){return f},window.getLoginTime=function(){return _},window.setCDRCallbackUrl=function(e){v=e},window.sendEvent=function(e){try{catchEvent(e)}catch(e){console.log(e.message)}},window.releaseExtension=function(){var e={campaign_id:f};$.ajax({type:"POST",url:"/mizuvoip/relext",data:e,dataType:"json",error:function(e){console.log("ERR RelExt"),console.log(e)}})},window.updateAgentStatus=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new Date,o={campaign_id:f,extension_id:r};null!=e?(o.agent_status=e,u!=e&&(u=e,s=new Date)):o.agent_status=u,o.status_duration=Math.floor((n.getTime()-s.getTime())/1e3),null!=t&&(o.connected_number=t),$.ajax({type:"POST",url:"/mizuvoip/updstat",data:o,dataType:"json",error:function(e){console.log("ERR UpdStat"),console.log(e)}}),g?d=setTimeout(updateAgentStatus,5e3):clearTimeout(d)},webphone_api.parameters.autostart=0,webphone_api.onAppStateChange((function(e){"loaded"===e?sendEvent("App Loaded"):"started"===e?(sendEvent("App Started"),updateAgentStatus("Ready",""),updateAuxState(),document.getElementById("btn_stop").style.visibility="visible"):"stopped"===e&&(releaseExtension(),_=null,sendEvent("App Stopped"),g=!1,updateAgentStatus("App Stopped"),document.getElementById("divMizuvoipControl").style.display="none")})),webphone_api.onRegStateChange((function(e){if("registered"===e)sendEvent("Ext Registered."),updateAgentStatus("Ready",""),updateAuxState();else if("unregistered"===e){switch(sendEvent("Ext UnRegistered."),parseInt(p)){case 1:updateAgentStatus("Aux Konsultasi","");break;case 2:updateAgentStatus("Aux Supporting","");break;case 3:updateAgentStatus("Aux CatHSTR","");break;case 4:updateAgentStatus("Aux Toilet","");break;case 5:updateAgentStatus("Aux Air Minum","");break;case 6:updateAgentStatus("Aux Sholat","");break;case 7:updateAgentStatus("Aux Lunch","");break;case 8:updateAgentStatus("Aux Briefing","");break;case 9:updateAgentStatus("Aux Update System","")}updateAuxState()}else"failed"===e&&(sendEvent("Ext Register failed."),updateAgentStatus("Ext Register failed",""))})),window.translateReason=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e in l.defined?Object.entries(l.defined[e]).forEach((function(e){var a=o(e,2),i=a[0],d=a[1],l=!0;Object.values(d).forEach((function(e){switch(e.operator){case"<":n[e.field]>=e.value&&(l=!1);break;case"<=":n[e.field]>e.value&&(l=!1);break;case"=":n[e.field]!=e.value&&(l=!1);break;case">":n[e.field]<=e.value&&(l=!1);break;case">=":n[e.field]<e.value&&(l=!1)}})),l&&(t=i)})):l.undefined.includes(e)||$.ajax({type:"POST",url:"/mizuvoip/updateReason",data:{extension_id:r,reason:e},dataType:"json",success:function(e){l=e},error:function(e){console.log("ERR UpdReason"),console.log(e)}}),t},webphone_api.onCdr((function(e,t,n,o,a,i,d,l){var r=new Array;r.duration=o,r.direction=a,r.line=l,r.connecttime=n,null!=v&&$.ajax({type:"POST",url:v,data:{campaign_id:f,reason:translateReason(d,r)},dataType:"json",success:function(e){},error:function(e){console.log("ERR CDRCallback"),console.log(e)}}),$.ajax({type:"POST",url:"/mizuvoip/handling",data:{campaign_id:f,duration:Math.floor((parseInt(o,10)+500)/1e3)},dataType:"json",error:function(e){console.log("ERR UpdHandling"),console.log(e)}})})),window.Start=function(){$.ajax({type:"POST",url:"/mizuvoip/getext",data:{campaign_id:f},dataType:"json",async:!1,success:function(e){null!=e?(webphone_api.setparameter("serveraddress",e.msg[0].serveraddress),webphone_api.setparameter("username",e.msg[0].name),webphone_api.setparameter("password",e.msg[0].password),r=e.msg[0].id,_=e.msg[0].login_time,sendEvent("Initializing"),webphone_api.start(),g=!0,l=JSON.parse(e.msg[0].reason)):sendEvent("Ext None Available")}})},window.Stop=function(){confirm("Logout ?")&&(webphone_api.isincall()?c=!0:webphone_api.stop())},window.Call=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!=e&&(document.getElementById("destnumber").value=e);var t=document.getElementById("destnumber").value;null==t&&(t=""),document.getElementById("destnumber").disabled=!0;var o,a=document.getElementsByClassName("bulkDialButton"),i=n(a);try{for(i.s();!(o=i.n()).done;){var d=o.value;d.disabled=!0}}catch(e){i.e(e)}finally{i.f()}webphone_api.setparameter("destination",t),webphone_api.call(t)},window.Hangup=function(){webphone_api.hangup(),sendEvent("Ext Registered.")},window.Hold=function(e){webphone_api.hold(e);var t={hold_val:e,campaign_id:f,key_val:b};$.ajax({type:"POST",url:"/mizuvoip/hold",data:t,dataType:"json",async:!1,success:function(t){e&&(b=t.key)},error:function(e){console.log("ERR Hold"),console.log(e)}}),e?(document.getElementById("btn_hold").innerText="un-Hold",document.getElementById("btn_hold").onclick=function(){Hold(!1)},updateAgentStatus("Hold")):(document.getElementById("btn_hold").innerText="Hold",document.getElementById("btn_hold").onclick=function(){Hold(!0)},updateAgentStatus("Call Connected"))},window.updateAuxState=function(){var e={aux_val:p,campaign_id:f,key_val:y};$.ajax({type:"POST",url:"/mizuvoip/aux",data:e,dataType:"json",success:function(e){y=0!=parseInt(p)?e.key:"key"},error:function(e){console.log("ERR Aux"),console.log(e)}})},window.Aux=function(){if(p=parseInt(document.getElementById("drp_aux").selectedIndex),0!=parseInt(p))if(webphone_api.isincall())m=!0;else{for(var e=1;e<10;e++)e!=parseInt(p)&&(document.getElementById("drp_aux_"+e).disabled=!0);webphone_api.unregister()}else{webphone_api.register();for(var t=1;t<10;t++)document.getElementById("drp_aux_"+t).disabled=!1}},window.Accept=function(){document.getElementById("incoming_call_layout").style.display="none",webphone_api.accept()},window.Reject=function(){document.getElementById("incoming_call_layout").style.display="none",webphone_api.reject()},webphone_api.onCallStateChange((function(e,t,n,o,a,i){if(sendEvent("Call "+e),"setup"===e)document.getElementById("btn_call").onclick=function(){Hangup()},document.getElementById("btn_call").classList.add("btn-danger"),document.getElementById("btn_call").classList.remove("btn-success"),1==t||2==t&&(document.getElementById("incoming_call_layout").style.display="block"),sendEvent("Call setup"),updateAgentStatus("Call Setup");else if("disconnected"===e){if(document.getElementById("btn_call").onclick=function(){Call()},document.getElementById("btn_call").classList.add("btn-success"),document.getElementById("btn_call").classList.remove("btn-danger"),m){for(var d=1;d<10;d++)d!=parseInt(p)&&(document.getElementById("drp_aux_"+d).disabled=!0);webphone_api.unregister(),m=!1}c&&(webphone_api.stop(),c=!1),document.getElementById("incoming_call_layout").style.display="none",sendEvent("Call disconnected"),updateAgentStatus("Call Disconnected"),document.getElementById("destnumber").disabled=!1}else"connected"===e&&(document.getElementById("destnumber").disabled=!0,updateAgentStatus("Call Connected",document.getElementById("destnumber").value))})),window.GetTickCount=function(){return(new Date).getTime()}}});